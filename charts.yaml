

## Extra repositories that aren't called out
## in `charts:` below.
repositories:
  paulczar: https://tech.paulcz.net/charts

## A list of helm charts to be installed
## anything in here can be overridden in
## `$env_dir/charts.yaml.gotmpl`

## `values:` is a list of .yaml or .yaml.gotmpl
## files that helmfile applies as to the chart
## as that chart's. helmfile will merge them in
## order with ascending priority.

## `raw:` is a list of of resources that you want
## to be rendered as raw manifests. This is used to
## add secrets and certs and other things that the
## helm chart itself may not support.

## `secrets:` is a list of encrypted secrets
## see: https://github.com/roboll/helmfile#secrets

charts:

  ingress:
    enabled: false
    name: ingress
    namespace: cluster-system
    repository:
      name: bitnami
      url: https://charts.bitnami.com/bitnami
    chart: bitnami/nginx-ingress-controller
    version: 5.3.16
    values:
      - charts/ingress/helmfile/base.yaml.gotmpl

  certManager:
    enabled: false
    repository:
      name: jetstack
      url: https://charts.jetstack.io
    name: cert-manager
    namespace: cert-manager
    chart: jetstack/cert-manager
    version: v0.16.1
    values:
      - charts/cert-manager/helmfile/base.yaml.gotmpl
    raw:
      - charts/cert-manager/helmfile/secrets.yaml.gotmpl
      - charts/cert-manager/helmfile/cluster-issuer.yaml.gotmpl
    # crds: charts/cert-manager/crds
    hooks:
      - events: ["presync"]
        command: "/bin/bash"
        args: ["-c", "./scripts/installCRDs ./charts/cert-manager/crds"]

  externalDNS:
    enabled: false
    name: external-dns
    repository:
      name: bitnami
      url: https://charts.bitnami.com/bitnami
    namespace: cluster-system
    version: 3.3.0
    chart: bitnami/external-dns
    values:
      - charts/externaldns/helmfile/base.yaml.gotmpl
    raw:
      - charts/externaldns/helmfile/secrets.yaml.gotmpl

  reloader:
    enabled: true
    name: reloader
    repository:
      name: stakater
      url: https://stakater.github.io/stakater-charts
    namespace: cluster-system
    version: v0.0.67
    chart: stakater/reloader
    values:
      - charts/reloader/helmfile/base.yaml.gotmpl

  ## Artifact Storage

  minio:
    enabled: true
    repository:
      name: bitnami
      url: https://charts.bitnami.com/bitnami
    name: minio
    namespace: minio
    chart: bitnami/minio
    version: 3.6.0
    values:
      - charts/minio/helmfile/values.yaml.gotmpl

  harbor:
    enabled: true
    repository:
      name: bitnami
      url: https://charts.bitnami.com/bitnami
    name: harbor
    namespace: harbor
    chart: /home/pczarkowski/development/github/bitnami/charts/bitnami/harbor
    # version: 7.1.0
    values:
      - charts/harbor/helmfile/values.yaml.gotmpl
    raw:
      - charts/harbor/helmfile/secrets.yaml.gotmpl

  ## Metrics
  grafana:
    enabled: true
    repository:
      name: bitnami
      url: https://charts.bitnami.com/bitnami
    name: grafana
    namespace: metrics
    chart: bitnami/grafana
    version: 3.3.5
    values:
      - charts/grafana/helmfile/bitnami-values.yaml.gotmpl
    raw:
      - charts/grafana/helmfile/bitnami-raw.yaml.gotmpl

  prometheus:
    enabled: false
    repository:
      name: stable
      url: https://kubernetes-charts.storage.googleapis.com
    name: prometheus
    namespace: metrics
    chart: stable/prometheus
    version: 11.0.2
    values:
      - charts/prometheus/helmfile/values.yaml.gotmpl

  prometheusOperator:
    enabled: true
    repository:
      name: bitnami
      url: https://charts.bitnami.com/bitnami
    name: prometheus-operator
    namespace: metrics
    chart: bitnami/prometheus-operator
    version: 0.29.4
    values:
      - charts/prometheus-operator/helmfile/values.yaml.gotmpl
    # crds: charts/prometheus-operator/crds
    hooks:
      - events: ["presync"]
        command: "/bin/bash"
        args: ["-c", "./scripts/installCRDs ./charts/prometheus-operator/crds"]

## Logging
## Generally speaking you'll only enable one set of either Loki+Promtail, or ELK
  loki:
    enabled: true
    repository:
      url: https://grafana.github.io/loki/charts
      name: loki
    name: loki
    namespace: logging
    chart: loki/loki
    version: 0.31.0
    values:
      - charts/loki/helmfile/values.yaml.gotmpl
    raw:
      - charts/loki/helmfile/raw.yaml.gotmpl

  promtail:
    enabled: true
    repository:
      url: https://grafana.github.io/loki/charts
      name: loki
    name: promtail
    namespace: logging
    chart: loki/promtail
    version: 0.24.0
    values:
      - charts/promtail/helmfile/values.yaml.gotmpl

  # misc
  kubeapps:
    enabled: true
    repository:
      url: https://charts.bitnami.com/bitnami
      name: bitnami
    name: kubeapps
    namespace: kubeapps
    chart: bitnami/kubeapps
    version: 3.4.3
    values:
      - charts/kubeapps/helmfile/values.yaml.gotmpl

  # wavefront
  wavefront:
    enabled: false
    repository:
      url: https://wavefronthq.github.io/helm/
      name: wavefront
    chart: wavefront/wavefront
    name: wavefront
    namespace: wavefront
    version: 1.1.6
    values:
      - charts/wavefront/helmfile/values.yaml.gotmpl

  keycloak:
    enabled: true
    repository:
      url: https://codecentric.github.io/helm-charts
      name: codecentric
    chart: codecentric/keycloak
    name: keycloak
    namespace: keycloak
    version: 9.0.1
    values:
      - charts/keycloak/helmfile/values.yaml.gotmpl
    raw:
      - charts/keycloak/helmfile/secrets.yaml.gotmpl
      - charts/keycloak/helmfile/create-users.yaml.gotmpl